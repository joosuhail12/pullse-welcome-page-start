@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
  .chat-message-bubble {
    @apply p-4 mb-3 rounded-2xl shadow-sm max-w-xs md:max-w-md transition-all duration-200;
  }
  
  .chat-message-system {
    @apply text-system-bubble-foreground rounded-br-none chat-message-bubble;
    background: linear-gradient(145deg, #f5f3ff 0%, #ede9fe 100%);
    box-shadow: 0 2px 8px rgba(139, 92, 246, 0.08);
  }
  
  .chat-message-user {
    @apply text-white rounded-bl-none chat-message-bubble;
    background: linear-gradient(145deg, #9672f7 0%, #8b5cf6 100%);
    box-shadow: 0 2px 8px rgba(139, 92, 246, 0.25);
  }

  /* Hover effect for actionable messages (with quick replies or buttons) */
  .chat-message-actionable:hover {
    @apply transform scale-[1.01] shadow-md;
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
  }
  
  /* Enhanced animation for message appearance */
  @keyframes message-appear {
    0% {
      opacity: 0;
      transform: translateY(10px) scale(0.98);
    }
    70% {
      opacity: 1;
      transform: translateY(-2px) scale(1.01);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  .message-animation-enter {
    animation: message-appear 0.4s ease-out forwards;
  }
  
  /* Date separator for message groups */
  .date-separator {
    @apply w-full flex items-center justify-center my-4;
  }
  
  .date-separator .date {
    @apply text-xs bg-gray-100 px-3 py-1.5 rounded-full text-gray-500 font-medium shadow-sm;
  }
  
  /* Typing indicator animation */
  @keyframes typing-bounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-5px);
    }
  }
  
  .animate-typing-bounce {
    animation: typing-bounce 0.8s ease-in-out infinite;
  }
  
  /* Improved focus states for keyboard navigation */
  :focus-visible {
    @apply outline-2 outline-offset-2 outline-vivid-purple;
    outline-style: solid;
  }
  
  /* Higher contrast colors for better accessibility */
  .text-gray-500 {
    @apply text-gray-600;  /* Darker gray for better contrast */
  }
  
  .text-gray-400 {
    @apply text-gray-600;  /* Darker gray for better contrast */
  }
  
  /* Accessible button focus styles */
  button:focus-visible {
    @apply ring-2 ring-offset-2 ring-vivid-purple;
  }

  /* NEW ANIMATIONS AND MICRO-INTERACTIONS */
  
  /* Message status animations */
  @keyframes status-change {
    0% { transform: scale(0.8); opacity: 0; }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); opacity: 1; }
  }
  
  .status-icon-animation {
    animation: status-change 0.3s ease-out forwards;
  }
  
  /* Message sending animation */
  @keyframes message-sending {
    0% { opacity: 0.7; }
    50% { opacity: 0.5; }
    100% { opacity: 0.7; }
  }
  
  .message-sending {
    animation: message-sending 1.2s infinite;
  }
  
  /* File upload micro-interactions */
  @keyframes file-upload-success {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); background-color: rgba(139, 92, 246, 0.15); }
    100% { transform: scale(1); }
  }
  
  .file-upload-success {
    animation: file-upload-success 0.5s ease-out;
  }
  
  /* Reaction micro-interactions */
  @keyframes reaction-selected {
    0% { transform: scale(1); }
    40% { transform: scale(1.3); }
    70% { transform: scale(0.9); }
    100% { transform: scale(1); }
  }
  
  .reaction-selected {
    animation: reaction-selected 0.4s ease-out;
  }
  
  /* Message delivery confirmation */
  @keyframes delivery-confirmation {
    0% { opacity: 0; transform: translateY(4px); }
    100% { opacity: 1; transform: translateY(0); }
  }
  
  .delivery-animation {
    animation: delivery-confirmation 0.3s ease-out;
  }

  /* Loading state pulse effect */
  @keyframes loading-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
  }
  
  .loading-pulse {
    animation: loading-pulse 1.5s infinite ease-in-out;
  }

  /* IMPROVED MESSAGE BUBBLE STYLES */
  .chat-message-user {
    @apply text-white chat-message-bubble;
    background: linear-gradient(135deg, #9672f7 0%, #8b5cf6 100%);
    box-shadow: 0 3px 12px rgba(139, 92, 246, 0.3);
    border-radius: 20px;
    border-bottom-right-radius: 4px;
    padding: 14px 16px;
    position: relative;
    z-index: 1;
    margin-left: auto;
    margin-right: 0;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }
  
  .chat-message-system {
    @apply text-system-bubble-foreground chat-message-bubble;
    background: linear-gradient(135deg, #f8f7ff 0%, #ede9fe 100%);
    box-shadow: 0 3px 12px rgba(139, 92, 246, 0.1);
    border-radius: 20px;
    border-bottom-left-radius: 4px;
    padding: 14px 16px;
    position: relative;
    z-index: 1;
    margin-right: auto;
    margin-left: 0;
    border: 1px solid rgba(139, 92, 246, 0.1);
  }
  
  /* Add bubble tails */
  .chat-message-user:after {
    content: '';
    position: absolute;
    bottom: 0;
    right: -8px;
    width: 16px;
    height: 16px;
    background: linear-gradient(225deg, #8b5cf6 0%, #8b5cf6 100%);
    border-bottom-left-radius: 16px;
    z-index: -1;
  }
  
  .chat-message-system:after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -8px;
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #ede9fe 0%, #ede9fe 100%);
    border-bottom-right-radius: 16px;
    z-index: -1;
  }
  
  /* Bubble hover effects */
  .chat-message-bubble:hover {
    transform: translateY(-1px);
    transition: transform 0.2s ease;
  }

  /* NEW HEADER STYLES */
  /* Pulsing status indicator */
  @keyframes pulse-ring {
    0% {
      transform: scale(0.95);
      opacity: 0.7;
    }
    50% {
      transform: scale(1.05);  
      opacity: 0.3;
    }
    100% {
      transform: scale(0.95);
      opacity: 0.7;
    }
  }
  
  .status-pulse {
    animation: pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite;
  }

  /* Header with pattern and gradients */
  .chat-header-pattern {
    position: relative;
    overflow: hidden;
    background-color: theme('colors.vivid-purple');
  }
  
  .chat-header-pattern::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 15%),
      radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 15%);
    opacity: 0.6;
    z-index: 1;
  }
  
  /* IMPORTANT MESSAGES STYLING */
  .important-message {
    @apply border-l-2 border-vivid-purple;
    box-shadow: 0 3px 10px rgba(139, 92, 246, 0.2);
  }
  
  .important-message-container {
    @apply bg-vivid-purple/5 rounded-lg p-1;
  }
  
  /* UNREAD MESSAGES DIVIDER */
  @keyframes unread-pulse {
    0% { background-color: rgba(239, 68, 68, 0.1); }
    50% { background-color: rgba(239, 68, 68, 0.2); }
    100% { background-color: rgba(239, 68, 68, 0.1); }
  }
  
  .unread-divider {
    @apply w-full py-1 px-2 text-center text-xs font-medium text-red-600 bg-red-100 rounded-sm my-2;
    animation: unread-pulse 2s ease-in-out infinite;
  }

  /* PRE-CHAT FORM ENHANCEMENTS */
  .pre-chat-form-container {
    @apply bg-white rounded-xl shadow-lg p-6 border border-gray-100;
    animation: form-appear 0.4s ease-out;
  }
  
  @keyframes form-appear {
    0% {
      opacity: 0;
      transform: translateY(20px) scale(0.96);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  .pre-chat-input {
    @apply transition-all duration-200;
  }
  
  .pre-chat-input:focus {
    @apply ring-2 ring-vivid-purple/30 border-vivid-purple;
  }
  
  .pre-chat-btn {
    @apply transition-all duration-200 transform hover:scale-[1.02] hover:shadow-md;
    box-shadow: 0 3px 10px rgba(139, 92, 246, 0.15);
  }
  
  /* Card-style message bubbles */
  .card-message-user {
    @apply rounded-lg border border-white/10 shadow-md;
    background: linear-gradient(145deg, #9672f7 0%, #8b5cf6 100%);
  }
  
  .card-message-system {
    @apply rounded-lg border border-gray-100 shadow-sm;
    background: linear-gradient(145deg, #f8f7ff 0%, #f5f3ff 100%);
  }
  
  /* Message group styling for consecutive messages */
  .message-group-first {
    @apply rounded-t-2xl rounded-bl-2xl rounded-br-md mt-2;
  }
  
  .message-group-middle {
    @apply rounded-md my-1;
  }
  
  .message-group-last {
    @apply rounded-b-2xl rounded-tr-2xl rounded-tl-md mb-2;
  }
}

/* Enhanced keyboard navigation indicators for chat components */
.chat-widget-container:focus-within {
  @apply ring-1 ring-vivid-purple/30;
}

/* Keyboard accessible elements */
[tabindex]:not([tabindex="-1"]):focus-visible {
  @apply ring-2 ring-vivid-purple ring-offset-2;
}
